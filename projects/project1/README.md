# Machine Learning - Class Project 1

This is the directory for the first class project of the Machine Learning course of Fall 2017 at EPFL. This file contains practical information on the project implementation and how to run it. For more detailed explanation of the project (models implemented, hyperparameter choosing, result validation...), please refer to the report (`report.pdf`). 

## Project structure

The project has the following folder (and file) structure:

* `data/`. Directory containing input data, namely `test.csv` and `train.csv` given by Kaggle.
* `out/`. Directory containing the output generated by the program, which contains files following `submission-{timestamp}.csv`. This output is compliant with the required format by Kaggle (described in `data/sample-submission.csv`).
* `scripts/`. Actual Python code of the implementation.
    * `clean_data.py`. Functions implementing preprocessing of input data.
    * `helpers.py`. Helper methods for ML algorithms.
    * `implementations.py`. Main implementations of the ML algorithms required in the project statement.
    * `parsers.py`. Functions for loading and storing data.
    * `plots.py`. Methods for generating plots (both supporting and for the report).
    * `run.py`. Entry point of the program containing the `main` routine.
    * `validation.py`. Functions for testing and validating results of different models, data cleaning and hyperparameters.
* `tmp/`. Folder containing cached data files.
* `clear.sh`. Clear all execution-derived data files (`out/` and `tmp/`) folders.

## Environment

The required environment for running the code and reproducing the results is a computer with a valid installation of Python 3. More specifically, [Python 3.6](https://docs.python.org/3.6/) is used.

Besides that (and the built-in Python libraries), the following packages are used and have to be installed:

* [NumPy 1.13.3](http://www.numpy.org). `pip3 install --user numpy==1.13.3`
* [Matplotlib 2.0.2](https://matplotlib.org). `pip3 install --user matplotlib==2.0.2`

## Running

### Main program

To run the main program, the `run.py` has to be executed from the scripts folder:

```
cd scripts/
python3 run.py
```

There are no command line arguments. It will look for a `train.csv` file located on `../data/` for training data and the same for `test.csv` and testing. Outputs will be generated in the `../out/` folder.

The program will output the following progress updates through the standard output:

```
PARSING TRAIN
PARSING TEST
FILTERING DATA
BUILDING POLYNOMIALS
LEARNING MODEL BY LEAST SQUARES
PREDICTING VALUES
EXPORTING CSV
```

### Plots

The plots displayed in the report are generated programmatically using Matplotlib. To reproduce them, the `plots.py` file can be called:

```
cd scripts/
python3 plots.py
```

This will output the plots on `out/` assuming the input data is located in the same places as when executing `run.py`.

### Data caching

Loading big datasets from `.csv` files is a slow task (roughly 15-20 seconds in a modern laptop), especially when developing. To solve this problem, a caching mechanism has been implemented: instead of loading raw `.csv`, the program loads `pickle`-encoded Python objects.

To do so, the main program detects if the required `.pckl` files are available in the `tmp/` folder. If so, it imports the objects into the variables used by the rest of the script. Otherwise it imports them from the `.csv` files and then dumps those objects to the `.pckl` files.
